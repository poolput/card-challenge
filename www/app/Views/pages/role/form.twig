{% extends "layout/index.html" %}
{% block head %}
{{ parent() }}
{% endblock %}
{% block content %}

<div class="pcoded-content">
	<div class="pcoded-inner-content">
		<div class="main-body">
			<div class="page-wrapper">
				<div class="page-header">
					<div class="row align-items-end">
						<div class="col-lg-4">
							<div class="page-header-breadcrumb">
								{{ breadcrumb|raw }}
							</div>
						</div>
						<div class="col-lg-8 text-right">
							<div class="page-header-title">
								<div class="d-inline">
									<h4>
										{{ title_body }}
									</h4>
									</span>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="page-body">
					<div class="row">

						<div class="col-sm-12">
							<div class="card">
								<div class="card-block">
									{% if warning_exist is not empty %}
									<div class="alert alert-warning background-warning">
										<button type="button" class="close" data-dismiss="alert" aria-label="Close">
											<i class="icofont icofont-close-line-circled text-white"></i>
										</button>
										<strong> </strong>
										{{ warning_exist }}
										<code>
											{{ post.email }}
										</code>
									</div>
									{% endif %}
									<h4 class="sub-title">Role Setting</h4>
									<form action="" method="post" autocomplete="on" id="form_role">
										<input type="hidden" name="role_id" id="role_id" value="{{ role.role_id }}">

										<div class="form-group row">
											<label class="col-sm-2 col-form-label">Role Name <span class="text-danger error">*</span></label>
											<div class="col-sm-10">
												<input type="text" class="form-control" name="role_name" id="role_name" value="{{ role.role_name }}"> <span class="messages"><p class="text-danger error">
														{{ incurrect_message }}
													</p> </span>
											</div>
										</div>
										<div class="form-group row">
											<label class="col-sm-2 col-form-label">Description </label>
											<div class="col-sm-10">
												<input type="text" class="form-control" name="description" id="description" value="{{ role.description }}"> <span class="messages"><p class="text-danger error">
														{{ incurrect_message }}
													</p> </span>
											</div>
										</div>

										<div class="row list-item pt-2 ">
											<div class=" col-md-12 ">
												<p class="border-top pt-2">
													Accession Branch ( <span class="branch-select">0</span> /&nbsp;
													{{ branchs|length }}
													) <span class="check pointer">Check All</span> / <span class="uncheck pointer">Uncheck All</span>
												</p>
											</div>
											<div class="col-md-12 pt-2">
												{% for branch in branchs %}
													{% set checked = '' %}
                                                    {% for role_branch in role_branchs %}
    													{% if role_branch.branch_id == branch.branch_id %}
    														{% set checked = ' checked="checked"' %}
    													{% endif %}
    												{% endfor %}
    												<div class="col-md-3 float-left">
    													<input type="checkbox" {{ checked }} name="branch[]" value="{{ branch.branch_id }}" class="branch"> &nbsp;
    													{{ branch.branch_name|capitalize }}
    												</div>
												{% endfor %}
											</div>
										</div>

										<div class="row pt-3 pb-3">
											<div class="col-md-12 text-right">
												<button type="button" class="btn btn-outline-secondary btn-cancel">Cancel</button>
												<button class="btn btn-secondary btn-save">&nbsp; Save &nbsp;</button>
											</div>
										</div>
									</form>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

{% endblock %}
{% block footer %}
{{ parent() }}
<script src="{{ base_url }}/theme/bower_components/i18next/js/i18next.min.js"></script>
<script src="{{ base_url }}/theme/bower_components/i18next-xhr-backend/js/i18nextXHRBackend.min.js"></script>
<script src="{{ base_url }}/theme/bower_components/i18next-browser-languagedetector/js/i18nextBrowserLanguageDetector.min.js"></script>
<script src="{{ base_url }}/theme/bower_components/jquery-i18next/js/jquery-i18next.min.js"></script>

<script src="{{ base_url }}/theme/assets/js/pcoded.min.js"></script>
<script src="{{ base_url }}/theme/assets/js/vartical-layout.min.js"></script>
<script src="{{ base_url }}/theme/assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="{{ base_url }}/theme/assets/js/script.js"></script>

<script>
$(function(){
      var total = 0;
      $('.branch').each(function(){
        	var checked = $(this).is(':checked');
        	if(checked == true){
        		total = total + 1;
          	}
      });
      $('.branch-select').html(total);
    	
      $('.branch').click(function(){
    	  total = 0;
    	  	$('.branch').each(function(){
    	  		var checked = $(this).is(':checked');
    	  		if(checked == true){
    	  			total = total + 1;
    		  	}
    		});
    		$('.branch-select').html(total);
      });
      $('.check').click(function(){
    	  	$('.branch').each(function(){
    	  		$(this).prop('checked', true);
    		});
    		$('.branch-select').html({{ branchs|length }});
    	});
      $('.uncheck').click(function(){
          	$('.branch').each(function(){
          		$(this).prop('checked', false);
        	});
          	$('.branch-select').html(0);
      });
  	$('.btn-cancel').click(function() {
		window.history.back();
		return false;
	});
	$('.btn-save').click(function() {
		return validate();
	});
});	

function validate(){
  	$('.messages').hide();

	var role_name = $('#role_name').val();
	var valid = 0;
	
	if(!role_name){
		$('#role_name').parent('div').find('.messages').show();
		valid = 1;
	}
	if (valid != 1) {
		return true;
	} else {
		return false;
	}
}
</script>
{% endblock %}