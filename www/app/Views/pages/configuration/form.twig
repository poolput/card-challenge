{% extends "layout/index.html" %}
{% block head %}
{{ parent() }}

<link rel="stylesheet" type="text/css" href="{{ base_url }}/theme/bower_components/select2/css/select2.min.css">
<style>
  .select2-container--default .select2-selection--single .select2-selection__rendered {
    background-color: #fff !important;
  }
  .select2-container .select2-selection--single {
    height: auto !important;
  }
</style>
{% endblock %}
{% block content %}

<div class="pcoded-content">
	<div class="pcoded-inner-content">
		<div class="main-body">
			<div class="page-wrapper">
				<div class="page-header">
					<div class="row align-items-end">
						<div class="col-lg-4">
							<div class="page-header-breadcrumb">
								{{ breadcrumb|raw }}
							</div>
						</div>
						<div class="col-lg-8 text-right">
							<div class="page-header-title">
								<div class="d-inline">
									<h4>
										{{ title_body }} {{ company_id }}
									</h4>
									</span>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="page-body">
					<div class="row">

            {% if is_root == 1 %}
              <div class="col-sm-12">
                <div class="card">
                  <div class="card-block">
                    <h4 class="sub-title">Company Setting (Root Only)</h4>
                    <form action="" method="post" autocomplete="on" id="configuration" enctype="multipart/form-data">
                      <div class="form-group row">
                        <div class="col-sm-1"></div>
  											<label class="col-sm-2 col-form-label">Company</label>
  											<div class="col-sm-8">
                          <select class="form-control" name="company_list" id="company_list">
                            <option value="">---Please Select Company---</option>
                            {% for company in companies %}
                              {% if company.company_id ==  company_data.company_id %}
                                <option value="{{ company.company_id }}" selected>{{ company.company_name }}</option>
                              {% else %}
                                <option value="{{ company.company_id }}">{{ company.company_name }}</option>
                              {% endif %}
                            {% endfor %}
                          </select>
                          <span class="messages"><p class="text-danger error">{{ incurrect_message }}</p></span>
  											</div>
                        <div class="col-sm-1"></div>
  										</div>
                    </form>
                  </div>
                </div>
              </div>
            {% endif %}

						<div class="col-sm-12">
							<div class="card">
								<div class="card-block">
									<!--<div class="alert alert-warning background-warning">
										<button type="button" class="close" data-dismiss="alert" aria-label="Close">
											<i class="icofont icofont-close-line-circled text-white"></i>
										</button>
										<strong>Warning!</strong> Add Class
										<code>{{ app.request('email')}}</code>
									</div>-->
									<h4 class="sub-title">Chart Setting</h4>
									<form action="" method="post" autocomplete="on" id="form_chart_setting" enctype="multipart/form-data">
										<div class="form-group row">
                      <div class="col-sm-1"></div>
											<label class="col-sm-2 col-form-label">Date Format<span class="text-danger error">*</span></label>
											<div class="col-sm-8">
                        <select class="form-control" name="date_format" id="date_format">
                          <option value="{{ date_format }}">---Please Select Date Format---</option>
                            {% for date_format in date_formats %}
                              <option value="{{ date_format.format }}" {% if setting.1 == date_format.format %} selected {% endif %}>{{ date_format.convertFormat }}</option>
                            {% endfor %}
                        </select>
                        <span class="messages"><p class="text-danger error">{{ incurrect_message }}</p></span>
											</div>
                      <div class="col-sm-1"></div>
										</div>
                    <div class="form-group row">
                      <div class="col-sm-1"></div>
											<label class="col-sm-2 col-form-label">Time Format<span class="text-danger error">*</span></label>
											<div class="col-sm-8">
                        <select class="form-control" name="time_format" id="time_format">
                            <option value="">---Please Select Time Format---</option>
                            {% for time_format in time_formats %}
                              <option value="{{ time_format.time }}" {% if setting.5 == time_format.time %} selected {% endif %}>{{ time_format.convertTime }}</option>
                            {% endfor %}
                        </select>
                        <span class="messages"><p class="text-danger error">{{ incurrect_message }}</p></span>
											</div>
                      <div class="col-sm-1"></div>
										</div>
                    <div class="form-group row">
                      <div class="col-sm-1"></div>
											<label class="col-sm-2 col-form-label">Week Start<span class="text-danger error">*</span></label>
											<div class="col-sm-8">
                        <select class="form-control" name="week_start" id="week_start">
                            <option value="">---Please Select Week Start---</option>
                            {% for week in weeks %}
                              <option value="{{ loop.index }}" {% if setting.7 == loop.index %} selected {% endif %}>{{ week }}</option>
                            {% endfor %}
                        </select>
                        <span class="messages"><p class="text-danger error">{{ incurrect_message }}</p></span>
											</div>
                      <div class="col-sm-1"></div>
										</div>
										<div class="row">
											<div class="col-md-12 text-right">
												<button type="button" class="btn btn-outline-secondary btn-cancel">Cancel</button>
												<button type="submit" class="btn btn-secondary btn-save">&nbsp; Save &nbsp;</button>
											</div>
										</div>
									</form>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

{% endblock %}
{% block footer %}
{{ parent() }}
<script src="{{ base_url }}/theme/bower_components/i18next/js/i18next.min.js"></script>
<script src="{{ base_url }}/theme/bower_components/i18next-xhr-backend/js/i18nextXHRBackend.min.js"></script>
<script src="{{ base_url }}/theme/bower_components/i18next-browser-languagedetector/js/i18nextBrowserLanguageDetector.min.js"></script>
<script src="{{ base_url }}/theme/bower_components/jquery-i18next/js/jquery-i18next.min.js"></script>
<script src="{{ base_url }}/theme/bower_components/select2/js/select2.full.min.js"></script>

<script src="{{ base_url }}/theme/assets/js/pcoded.min.js"></script>
<script src="{{ base_url }}/theme/assets/js/vartical-layout.min.js"></script>
<script src="{{ base_url }}/theme/assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="{{ base_url }}/theme/assets/js/script.js"></script>

<script>
      $(document).ready(function(){

          $('#company_list').change(function(){
            var company_id = $('#company_list').val();

            $.ajax({
              type: "POST",
              url: "{{ base_url }}/configuration/changeCompany",
              data: {company_id: company_id},
              cache: false,
              success: function(data){
                var obj = JSON.parse(data);

                window.location.reload(false);
              }
            });
          });

          $('.btn-cancel').click(function() {
            window.history.back();
          });

          $('.btn-save').click(function() {
            $('.messages').hide();

            var group_chk = 0;
            var date_format = $("#date_format").val();
            var time_format = $("#time_format").val();
            var week_start = $("#week_start").val();

            if(date_format == ''){
              $('#date_format').parent('div').find('.messages').show();
              group_chk = 1;
            }
            if(time_format == ''){
              $('#time_format').parent('div').find('.messages').show();
              group_chk = 1;
            }
            if(week_start == ''){
              $('#week_start').parent('div').find('.messages').show();
              group_chk = 1;
            }

            if(group_chk == 1){
              return false;
            }
          });

      });
</script>
{% endblock %}
